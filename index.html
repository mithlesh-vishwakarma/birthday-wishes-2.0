<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Happy Birthday ‚Äî Smooth 3D Carousel</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  html, body { height: 100%; }
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #0a0a0f 0%, #1a0a1f 50%, #0f0a1a 100%);
    color: #f3e8ff;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    overflow: hidden;
  }

  /* Container */
  .wrap {
    width: 100%;
    max-width: 1200px;
    position: relative;
    z-index: 10;
  }

  .header { text-align: center; margin-bottom: 18px; }
  .header h1 {
    font-size: clamp(28px, 5vw, 48px);
    font-weight: 700;
    background: linear-gradient(135deg, #a855f7, #ec4899, #f97316);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 0 0 30px rgba(168,85,247,0.35);
  }

  .subtitle {
    color: #e9d5ff;
    margin-top: 6px;
    font-style: italic;
    opacity: 0.95;
  }

  .carousel-stage {
    position: relative;
    width: 100%;
    height: 520px;
    perspective: 1200px;
    margin: 20px 0 28px;
    user-select: none;
    touch-action: pan-y;
  }

  .carousel {
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    position: relative;
    transition: transform 600ms cubic-bezier(.2,.8,.2,1);
  }

  .item {
    position: absolute;
    left: 50%;
    top: 50%;
    transform-style: preserve-3d;
    width: clamp(180px, 28vw, 320px);
    height: clamp(260px, 36vw, 420px);
    border-radius: 18px;
    overflow: hidden;
    will-change: transform, opacity, filter;
    box-shadow:
      0 18px 50px rgba(0,0,0,0.6),
      inset 0 0 30px rgba(168,85,247,0.05);
    border: 2px solid rgba(168,85,247,0.18);
    background: linear-gradient(135deg, rgba(79, 40, 120, 0.12), rgba(236,72,153,0.06));
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transform-origin: center center;
  }

  /* decorative shine */
  .item::before {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(120deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    pointer-events: none;
  }

  /* Controls */
  .controls {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-bottom: 18px;
  }

  .btn {
    padding: 10px 18px;
    border-radius: 999px;
    font-weight: 600;
    border: 1px solid rgba(168,85,247,0.25);
    background: linear-gradient(135deg, rgba(168,85,247,0.12), rgba(236,72,153,0.08));
    color: #f3e8ff;
    cursor: pointer;
    backdrop-filter: blur(6px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.45);
  }
  .btn:active { transform: translateY(1px); }

  .info {
    text-align: center;
    color: #e9d5ff;
    font-size: 14px;
    margin-bottom: 10px;
    opacity: 0.9;
  }

  .message-box {
    background: rgba(20,10,30,0.58);
    border: 1px solid rgba(168,85,247,0.16);
    border-radius: 14px;
    padding: 18px;
    max-width: 900px;
    margin: 0 auto 8px;
    text-align: center;
    color: #f3e8ff;
  }

  .footer {
    text-align: center;
    margin-top: 6px;
    color: #f3e8ff;
    opacity: 0.95;
    font-weight: 600;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .carousel-stage { height: 420px; }
    .message-box { padding: 14px; }
  }
  @media (max-width: 480px) {
    .carousel-stage { height: 360px; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <h1>‚ú® Happy Birthday My Everything ‚ú®</h1>
      <div class="subtitle">To the one who means the world to me</div>
    </div>

    <div class="message-box">
      <div>You are not just my <strong style="color:#e879f9">sister</strong>, you are my best friend and my whole heart. Enjoy the memories and the smiles today.</div>
    </div>

    <div class="info">Drag to rotate ‚Ä¢ Swipe on mobile ‚Ä¢ Use controls to play or step</div>

    <div class="carousel-stage" id="stage">
      <div class="carousel" id="carousel" aria-hidden="false"></div>
    </div>

    <div class="controls">
      <button class="btn" id="prev">‚Üê Previous</button>
      <button class="btn" id="playPause">Pause</button>
      <button class="btn" id="next">Next ‚Üí</button>
    </div>

    <div class="footer">Forever grateful to have you in my life üíï</div>
  </div>

<script>
/*
  Ultra-smooth 3D Carousel
  Features:
  - sample images (Unsplash) used here
  - requestAnimationFrame for smooth animation
  - momentum and friction for drag release
  - depth-based scale, opacity and blur
  - prev/next/play/pause controls
*/

/* --------- Configuration --------- */
const IMAGE_COUNT = 12;
const radiusDesktop = 520;      // radius for 3D circle on desktop
const radiusMobile = 300;       // radius for mobile
const autoSpeed = 0.025;        // base rotational velocity per ms
const friction = 0.95;          // drag friction when releasing
const snapEasing = 0.08;        // easing to align to a nicer angle when stopped

/* --------- Sample images (Unsplash) ---------
   Replace these URLs with your own if you want.
*/
const images = [
  "https://images.unsplash.com/photo-1545235617-9465f6f6fb9b?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1534126511673-b6899657816a?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1504198453319-5ce911bafcde?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1483985988355-763728e1935b?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1487412947147-5cebf100ffc2?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?auto=format&fit=crop&w=1200&q=60",
  "https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=1200&q=60"
];

/* --------- DOM references --------- */
const carousel = document.getElementById('carousel');
const stage = document.getElementById('stage');
const prevBtn = document.getElementById('prev');
const nextBtn = document.getElementById('next');
const playPauseBtn = document.getElementById('playPause');

let items = [];
let angle = 0;               // current rotation angle in degrees
let velocity = 0;            // rotational velocity in degrees per ms
let lastTime = null;
let running = true;
let pointerActive = false;
let pointerStartX = 0;
let pointerStartAngle = 0;
let lastPointerX = 0;
let autoRotate = true;

/* Create items */
const total = Math.min(IMAGE_COUNT, images.length);
for (let i = 0; i < total; i++) {
  const el = document.createElement('div');
  el.className = 'item';
  const img = document.createElement('img');
  img.src = images[i % images.length];
  img.alt = 'photo ' + (i + 1);
  el.appendChild(img);
  carousel.appendChild(el);
  items.push(el);
}

/* Layout calculation and update */
function updateLayout() {
  const w = window.innerWidth;
  const radius = w < 768 ? radiusMobile : radiusDesktop;
  const angleStep = 360 / total;

  items.forEach((el, i) => {
    // Compute local angle for this item
    const a = (angle + i * angleStep) * Math.PI / 180;
    const x = Math.sin(a) * radius;
    const z = Math.cos(a) * radius;

    // Normalize z to [0,1] for scale/opacity/blur mapping
    const zNormalized = (z + radius) / (2 * radius); // 0..1

    // Compute transform values
    const scale = 0.6 + zNormalized * 0.9; // 0.6 .. 1.5
    const translateX = x;
    const translateZ = z * 0.65; // push further back less to avoid clipping
    const rotateY = (angle + i * angleStep) % 360;

    el.style.transform = `
      translate(-50%, -50%)
      translate3d(${translateX}px, 0px, ${translateZ}px)
      scale(${scale})
      rotateY(${rotateY}deg)
    `;
    el.style.opacity = (0.35 + zNormalized * 1.1).toFixed(3);
    el.style.zIndex = Math.round(z);
    // depth blur: closer items less blur
    const blurPx = Math.max(0, 12 * (1 - zNormalized));
    el.style.filter = `blur(${blurPx}px) saturate(${0.9 + zNormalized})`;
  });

  // Slight rotation of whole carousel to add 3D feel
  const tilt = Math.max(-12, Math.min(12, (angle / 14)));
  carousel.style.transform = `rotateX(8deg) rotateZ(${tilt}deg)`;
}

/* Animation loop using requestAnimationFrame */
function rafLoop(ts) {
  if (!lastTime) lastTime = ts;
  const dt = ts - lastTime;
  lastTime = ts;

  // Auto rotation velocity applied as degrees per ms
  if (autoRotate && Math.abs(velocity) < 0.0001) {
    // small base auto rotation when idle
    velocity += autoSpeed * dt * 0.0004;
  }

  // Apply velocity to angle
  if (!pointerActive) {
    // apply friction
    velocity *= friction;
    if (Math.abs(velocity) < 0.00002) velocity = 0;
    angle += velocity * dt;
  } else {
    // while pointer active we do not apply friction here
  }

  // soft snap when velocity is tiny and not dragging
  if (!pointerActive && Math.abs(velocity) < 0.02 && !draggingMomentum) {
    // gently nudge to nearest "neutral" angle that keeps items comfortable
    const angleStep = 360 / total;
    const nearest = Math.round(angle / angleStep) * angleStep;
    angle += (nearest - angle) * snapEasing;
  }

  updateLayout();

  if (running) requestAnimationFrame(rafLoop);
}

/* Drag and momentum */
let draggingMomentum = false;
function pointerDown(e) {
  pointerActive = true;
  draggingMomentum = false;
  lastTime = null; // reset rAF timing to avoid huge dt
  stopAuto(); // stop auto rotation while user interacts

  const clientX = (e.touches) ? e.touches[0].clientX : e.clientX;
  pointerStartX = clientX;
  pointerStartAngle = angle;
  lastPointerX = clientX;
  velocity = 0;
}

function pointerMove(e) {
  if (!pointerActive) return;
  const clientX = (e.touches) ? e.touches[0].clientX : e.clientX;
  const dx = clientX - pointerStartX;
  // convert pixels to degrees by sensitivity
  const sensitivity = 0.25; // lower is less sensitive
  angle = pointerStartAngle + dx * sensitivity;
  // estimate velocity based on pointer delta
  const now = performance.now();
  const dt = 16; // approximate
  const vx = (clientX - lastPointerX) / (dt || 16);
  velocity = vx * 0.18; // tuned multiplier
  lastPointerX = clientX;
}

function pointerUp(e) {
  if (!pointerActive) return;
  pointerActive = false;

  // start momentum: velocity already set from pointerMove; we flag draggingMomentum
  draggingMomentum = Math.abs(velocity) > 0.02;
  if (!draggingMomentum) {
    // small velocity: resume auto rotate after short delay
    setTimeout(() => startAuto(), 500);
  } else {
    // resume auto after momentum decays
    setTimeout(() => startAuto(), 1200);
  }
}

/* Controls */
prevBtn.addEventListener('click', () => {
  // rotate one item step backward smoothly
  const step = 360 / total;
  velocity = 0;
  angle -= step;
});

nextBtn.addEventListener('click', () => {
  const step = 360 / total;
  velocity = 0;
  angle += step;
});

playPauseBtn.addEventListener('click', () => {
  autoRotate = !autoRotate;
  playPauseBtn.textContent = autoRotate ? 'Pause' : 'Play';
  if (autoRotate) startAuto(); else stopAuto();
});

/* Pointer events */
stage.addEventListener('pointerdown', (e) => {
  stage.setPointerCapture(e.pointerId);
  pointerDown(e);
});
stage.addEventListener('pointermove', (e) => {
  if (pointerActive) pointerMove(e);
});
stage.addEventListener('pointerup', (e) => {
  pointerUp(e);
  try { stage.releasePointerCapture(e.pointerId); } catch(err){}
});
stage.addEventListener('pointercancel', () => { pointerActive = false; });

/* Touch fallback for older browsers */
stage.addEventListener('touchstart', (e) => pointerDown(e), {passive: true});
stage.addEventListener('touchmove', (e) => pointerMove(e), {passive: false});
stage.addEventListener('touchend', (e) => pointerUp(e));

/* Auto start/stop helpers */
function startAuto() { autoRotate = true; playPauseBtn.textContent = 'Pause'; }
function stopAuto() { autoRotate = false; playPauseBtn.textContent = 'Play'; }

/* Resize handling */
let resizeTimer;
function handleResize() {
  clearTimeout(resizeTimer);
  resizeTimer = setTimeout(() => updateLayout(), 120);
}
window.addEventListener('resize', handleResize);

/* Kick off animation */
requestAnimationFrame(rafLoop);

/* Initial layout */
updateLayout();

/* Accessibility: keyboard controls */
window.addEventListener('keydown', (e) => {
  if (e.key === 'ArrowLeft') prevBtn.click();
  if (e.key === 'ArrowRight') nextBtn.click();
  if (e.key === ' ') { e.preventDefault(); playPauseBtn.click(); }
});

</script>
</body>
</html>
